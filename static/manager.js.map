{"version":3,"file":null,"sources":["../src/utils.js","../src/rulerow.js","../src/manager.js"],"sourcesContent":["const {rpc} = Serverboards\n\nconst plugin_id = 'serverboards.backup.monitor'\n\nexport function basename(filepath){\n  var parts=filepath.split('/')\n  if (parts.length==0)\n    return ''\n  return parts[parts.length-1]\n}\n\n// from MDN https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest\nexport function hex(buffer) {\n  var hexCodes = [];\n  var view = new DataView(buffer);\n  for (var i = 0; i < view.byteLength; i += 4) {\n    // Using getUint32 reduces the number of iterations needed (we process 4 bytes each time)\n    var value = view.getUint32(i)\n    // toString(16) will give the hex representation of the number without padding\n    var stringValue = value.toString(16)\n    // We use concatenation and slice for padding\n    var padding = '00000000'\n    var paddedValue = (padding + stringValue).slice(-padding.length)\n    hexCodes.push(paddedValue);\n  }\n\n  // Join all the hex strings into one\n  return hexCodes.join(\"\");\n}\n\nexport function old_backup(date){\n  // must match today date or yesterdays\n  var today = (new Date()).toISOString().slice(0,10)\n  var yesterday_d = new Date()\n  yesterday_d.setDate(yesterday_d.getDate()-1)\n\n  var yesterday = yesterday_d.toISOString().slice(0,10)\n  return date == today || date == yesterday\n}\n\nexport function get_servername(uuid){\n  let p = new Promise(function(accept, reject){\n    rpc.call(\"service.info\", [uuid]).then( (service) => {\n      accept(service.name)\n    }).catch( (e) => {\n      reject( e )\n    })\n  })\n  return p\n}\n\n\nexport function get_state({file_expression, service}){\n  var to_check = new TextEncoder(\"utf-8\").encode(file_expression + \"-\" + service);\n  var p = crypto.subtle.digest(\"SHA-256\", to_check).then( (sha) => {\n    var key=\"test-\"+hex(sha)\n    return rpc.call(\"plugin.data_get\",[plugin_id, key])\n  } ).then( (data) => {\n    if (!data.filename){\n      return {\n        color: \"red\",\n        state: \"Cant get data from any backup. Maybe not performed yet?\"\n      }\n    }\n    const is_old = old_backup(data.datetime)\n    return {\n      filename: data.filename,\n      datetime: data.datetime.slice(0,16).replace('T',' '),\n      color: is_old ? \"red\" : \"green\",\n      state: is_old ? \"Old backup. Check ASAP\" : \"Ok\",\n      size: data.size,\n    }\n  }).catch((e) => {\n    console.error(e)\n    return {\n      color: \"red\",\n      state: e.toString()\n    }\n  })\n\n  return p\n}\n","const { React, rpc } = Serverboards\nconst plugin_id = 'serverboards.backup.monitor'\nimport { get_state } from './utils'\n\nconst LABEL_ACTION='serverboards.core.actions/set-tags'\n\nconst EditFileRow = React.createClass({\n  getInitialState(){\n    let action='custom'\n    if (this.props.rule.actions && this.props.rule.actions.length !=0 ){\n      if (this.props.rule.actions.exists && this.props.rule.actions.exists.action==LABEL_ACTION)\n        action='labels'\n      if (this.props.rule.actions['not-exists'] && this.props.rule.actions['not-exists'].action=='serverboards.core.actions/send_notification')\n        action='notification'\n    }\n\n    return {\n      color: this.props.rule.is_active ? 'yellow' : 'grey',\n      state: 'Checking status',\n      action: action\n    }\n  },\n  componentDidMount(){\n    $(this.refs.services).dropdown()\n    $(this.refs.actions).dropdown()\n    $(this.refs.checkbox).checkbox({\n       onChange: this.saveChanges\n    })\n\n    get_state(this.props.rule).then( (state) => {\n      this.setState({color: this.props.rule.is_active ? state.color : \"grey\", state: state.state})\n    })\n  },\n  get_actions(action_name){\n    // Only will change if modified\n    let actions = this.props.rule.actions\n    if (action_name != this.state.action){\n      switch(action_name){\n        case 'labels':\n          actions={\n            exists:{\n              action:LABEL_ACTION,\n              params:{\n                tags: \"-BACKUP_FAIL\"\n              }\n            },\n            \"not-exists\":{\n              action:LABEL_ACTION,\n              params:{\n                tags: \"BACKUP_FAIL\"\n              }\n            }\n          }\n        break;\n        case 'notification':\n          {\n            const $el=$(this.refs.el)\n            const service = $el.find('[name=service]').val()\n            const file_expression = $el.find('[name=file_expression]').val()\n            actions={\n              \"not-exists\":{\n                action:'serverboards.core.actions/send_notification',\n                params:{\n                  title: \"Backup was not properly performed\",\n                  email: \"@user\",\n                  body: `Backup at ${this.props.services.find( (s) => s.uuid == service ).name}, file ${file_expression} failed.\\n\\nPlease check ASAP.`\n                }\n              }\n            }\n          break;\n        }\n      }\n    }\n    return actions\n  },\n  saveChanges(){\n    const $el=$(this.refs.el)\n    const status={\n      service: $el.find('[name=service]').val(),\n      file_expression: $el.find('[name=file_expression]').val(),\n      when: $el.find('[name=when]').val(),\n      action: $el.find('[name=action]').val(),\n      is_active: $el.find('[name=is_active]').is(':checked')\n    }\n\n    {\n      const rule = this.props.rule\n      if (\n          status.service == rule.service &&\n          status.file_expression == rule.file_expression &&\n          status.when == rule.when &&\n          status.action == this.state.action &&\n          status.is_active == rule.is_active\n        )\n          return; // Nothing changed\n    }\n\n    const props=this.props\n\n    let actions=this.get_actions(status.action)\n\n    let rule={\n      uuid: props.rule.uuid,\n      name: props.rule.name || \"Remote file check\",\n      description: props.rule.description,\n      is_active: status.is_active,\n      service: status.service,\n      serverboard: props.serverboard.shortname,\n      trigger: {\n        trigger: `${plugin_id}/file_exists`,\n        params: {\n          file_expression: status.file_expression,\n          when: status.when\n        }\n      },\n      actions: actions\n    }\n\n    this.setState({color: \"blue\"})\n    rpc.call(\"rules.update\", rule).then( () => {\n      this.setState({color: \"yellow\"})\n      return get_state({file_expression: status.file_expression, service: status.service})\n    }).then( (state) => {\n      this.props.handleReload()\n      this.setState({ color: rule.is_active ? state.color : \"grey\", state: state.state })\n    }\n    ).catch( (e) => {\n      console.log(e)\n      Serverboards.Flash.error(\"Error updating rule\")\n    })\n  },\n  render(){\n    const props=this.props\n    const state=this.state\n    return (\n      <tr className=\"ui form\" ref=\"el\">\n        <td><i className={`ui circular ${state.color} small label`} data-tooltip={state.state}/></td>\n        <td><div ref=\"checkbox\" className=\"ui checkbox toggle\"><input type=\"checkbox\" name=\"is_active\" defaultChecked={props.rule.is_active}/></div></td>\n        <td>\n          <select ref=\"services\" name=\"service\" className=\"ui dropdown\" defaultValue={props.rule.service} onChange={this.saveChanges}>\n            <option value=\"\">No service selected yet</option>\n            {this.props.services.map( (s) => (\n              <option value={s.uuid}>{s.name}</option>\n            ))}\n          </select>\n        </td>\n        <td className=\"ui field\" style={{width: \"36em\"}}>\n          <input type=\"text\" name=\"file_expression\" className=\"ui field\" defaultValue={props.rule.file_expression}  onBlur={this.saveChanges}/>\n        </td>\n        <td className=\"ui field\" style={{width: \"8em\"}}>\n          <input type=\"text\" name=\"when\" className=\"ui field\" defaultValue={props.rule.when}  onBlur={this.saveChanges}/>\n        </td>\n        <td>\n          <select ref=\"actions\" name=\"action\" defaultValue={state.action} onChange={this.saveChanges}>\n            <option value=\"custom\">Custom</option>\n            <option value=\"labels\">Set service labels</option>\n            <option value=\"notification\">Send notification</option>\n          </select>\n        </td>\n      </tr>\n    )\n  }\n})\n\nexport default EditFileRow\n","const { React, rpc } = Serverboards\nconst plugin_id = 'serverboards.backup.monitor'\nimport { get_state } from './utils'\nimport EditFileRow from './rulerow'\n\nfunction by_when(A, B){\n  return A.when.localeCompare( B.when, undefined, {numeric: true} )\n}\n\nconst Manager=React.createClass({\n  getInitialState(){\n    const services = this.props.serverboard.services.filter( (s) => s.type == \"serverboards.core.ssh/ssh\" )\n    return {\n      services: services,\n      rules: []\n    }\n  },\n  componentDidMount(){\n    this.reload_rules()\n  },\n  reload_rules(){\n    rpc.call(\"rules.list\", {serverboard:this.props.serverboard.shortname}).then( (all_rules) => {\n      const rules = all_rules\n        .filter( (r) => r.trigger.trigger == `${plugin_id}/file_exists` )\n        .map( (r) => ({\n          file_expression: r.trigger.params.file_expression,\n          service: r.service,\n          when: r.trigger.params.when,\n          uuid: r.uuid,\n          description: r.description,\n          name: r.name,\n          is_active: r.is_active,\n          actions: r.actions\n        }))\n      this.setState({rules})\n    })\n  },\n  handleAddRule(){\n    rpc.call(\"rules.update\",{\n      trigger: {\n        trigger: `${plugin_id}/file_exists`,\n        params: { file_expression:\"\", when: \"7am\" },\n      },\n      actions: [],\n      serverboard: this.props.serverboard.shortname,\n    }).then( () => {\n      this.reload_rules()\n    })\n  },\n  render(){\n    const props=this.props\n    const state=this.state\n\n    return (\n      <div className=\"ui central container\">\n        <h1 className=\"ui header\">Backup Monitor Manager</h1>\n        <div className=\"ui meta\">Easy manage the backup watchers rules. </div>\n\n        <table className=\"ui table\">\n          <thead>\n            <tr>\n              <th/>\n              <th/>\n              <th>Service</th>\n              <th>File path</th>\n              <th>Check time</th>\n              <th>Action</th>\n            </tr>\n          </thead>\n          <tbody>\n            {state.rules.sort(by_when).map( (r) => (\n              <EditFileRow rule={r} services={state.services} serverboard={props.serverboard} handleReload={this.reload_rules}/>\n            ))}\n          </tbody>\n        </table>\n        <button className=\"ui yellow button\">Update backup rules changes</button>\n\n        <a className=\"ui massive button _add icon floating green\" onClick={this.handleAddRule}>\n          <i className=\"add icon\"></i>\n        </a>\n\n      </div>\n    )\n  }\n})\n\nconst main=function(el, config){\n  Serverboards.ReactDOM.render(React.createElement(Manager, {serverboard: config.serverboard}), el)\n\n  return function(){\n    Serverboards.ReactDOM.unmountComponentAtNode(el)\n  }\n}\n\nServerboards.add_screen(plugin_id+\"/manager\", main)\n"],"names":["Serverboards","rpc","plugin_id","buffer","view","i","byteLength","getUint32","stringValue","value","toString","padding","paddedValue","slice","length","hexCodes","push","join","date","toISOString","yesterday_d","setDate","getDate","today","yesterday","file_expression","service","to_check","encode","p","crypto","subtle","digest","then","sha","hex","call","key","data","filename","color","state","old_backup","datetime","replace","is_old","size","catch","e","error","React","EditFileRow","createClass","getInitialState","props","rule","actions","exists","action","LABEL_ACTION","is_active","componentDidMount","$","refs","services","dropdown","checkbox","onChange","saveChanges","get_state","setState","get_actions","action_name","params","tags","el","$el","find","val","title","email","body","s","uuid","name","status","when","is","description","serverboard","shortname","trigger","handleReload","console","log","Flash","render","map","width","A","B","localeCompare","numeric","filter","type","rules","reload_rules","all_rules","r","handleAddRule","sort","by_when","main","config","ReactDOM","createElement","Manager","unmountComponentAtNode","add_screen"],"mappings":"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"}